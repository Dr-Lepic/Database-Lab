-- ACCOUNT TABLE
CREATE TABLE ACCOUNT(
	ACCOUNT_NO CHAR(5) PRIMARY KEY,
	BALANCE INT NOT NULL
    
);

-- CUSTOMER TABLE
CREATE TABLE CUSTOMER(
	CUSTOMER_NO CHAR(5) PRIMARY KEY,
    CUSTOMER_NAME VARCHAR(20) NOT NULL,
    CUSTOMER_CITY VARCHAR(10)
    
);

-- DEPOSITOR TABLE
CREATE TABLE DEPOSITOR(
	ACCOUNT_NO CHAR(5),
    CUSTOMER_NO CHAR(5),
    PRIMARY KEY(ACCOUNT_NO, CUSTOMER_NO)
);

-- 2.A
ALTER TABLE CUSTOMER ADD DATE_OF_BIRTH DATE;
-- 2.B
ALTER TABLE ACCOUNT MODIFY BALANCE DECIMAL(12, 2);
-- 2.C 
ALTER TABLE DEPOSITOR RENAME COLUMN ACCOUNT_NO TO A_NO;
ALTER TABLE DEPOSITOR RENAME COLUMN CUSTOMER_NO TO C_NO;
-- 2.D
ALTER TABLE DEPOSITOR RENAME TO DEPOSITOR_INFO;
-- 2.E
-- ALTER TABLE DEPOSITOR_INFO DROP FOREIGN KEY FK_DEPOSITOR_ACCOUNT;
ALTER TABLE DEPOSITOR_INFO ADD CONSTRAINT FK_DEPOSITOR_ACCOUNT FOREIGN KEY (A_NO) REFERENCES ACCOUNT(ACCOUNT_NO) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE DEPOSITOR_INFO ADD CONSTRAINT FK_DEPOSITOR_CUSTOMER FOREIGN KEY (C_NO) REFERENCES CUSTOMER(CUSTOMER_NO) ON DELETE CASCADE ON UPDATE CASCADE;
-- 3 
INSERT INTO ACCOUNT (ACCOUNT_NO, BALANCE) VALUES
('SWE12', 4900),
('SWE13', 5900),
('SWE14', 6400),
('SWE15', 5600),
('SWE16', 3400),
('SWE17', 7800);

INSERT INTO CUSTOMER (CUSTOMER_NO, CUSTOMER_NAME, CUSTOMER_CITY, DATE_OF_BIRTH) VALUES
('CUS12', 'Mahbub', "KHL", '2002-09-10'),
('CUS13', 'Rahim', "RJH", '2004-07-21'),
('CUS14', 'Karim', "CTG", '2002-05-26'),
('CUS15', 'Rahman', "CHK", '2006-06-24'),
('CUS16', 'Abul', "KHL", '2004-07-10'),
('CUS17', 'Abdul', "DHK", '2001-04-16');

INSERT INTO DEPOSITOR_INFO (A_NO, C_NO) VALUES 
('SWE12', 'CUS12'),
('SWE13', 'CUS13'),
('SWE14', 'CUS14'),
('SWE15', 'CUS15'),
('SWE16', 'CUS16'),
('SWE17', 'CUS17');

-- 4.A
SELECT ACCOUNT_NO FROM ACCOUNT WHERE BALANCE < 100000;
-- 4.B
SELECT CUSTOMER_NAME FROM CUSTOMER WHERE CUSTOMER_CITY = 'KHL';
-- 4.C
SELECT * FROM ACCOUNT, DEPOSITOR_INFO; 
-- 4.D
SELECT * FROM CUSTOMER NATURAL JOIN DEPOSITOR_INFO;
-- 4.E
SELECT CUSTOMER_NAME, CUSTOMER_CITY FROM CUSTOMER, DEPOSITOR_INFO WHERE CUSTOMER.CUSTOMER_NO = DEPOSITOR_INFO.C_NO;
-- 4.F
SELECT * FROM CUSTOMER WHERE CUSTOMER_NO IN (SELECT C_NO FROM DEPOSITOR_INFO WHERE A_NO IN (SELECT ACCOUNT_NO FROM ACCOUNT WHERE BALANCE > 1000));
-- 4.G
SELECT * FROM ACCOUNT WHERE BALANCE BETWEEN 5000 AND 10000 OR ACCOUNT_NO IN (SELECT A_NO FROM DEPOSITOR_INFO WHERE C_NO IN (SELECT CUSTOMER_NO FROM CUSTOMER WHERE CUSTOMER_CITY = 'DHK')); 
-- 5.A 
UPDATE CUSTOMER SET CUSTOMER_CITY = 'KLN' WHERE CUSTOMER_CITY = 'KHL';
-- 5.B
UPDATE CUSTOMER SET CUSTOMER_NO = 'CUS32' WHERE CUSTOMER_NO = 'CUS17';
-- 5.c
DELETE FROM CUSTOMER WHERE CUSTOMER_NO = 'CUS32';
-- 5.d
DELETE FROM ACCOUNT;
DELETE FROM CUSTOMER;
DELETE FROM DEPOSITOR_INFO;